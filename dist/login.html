<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>InSync Nexus Login</title><script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script><link rel="stylesheet" href="34dba35fef813ba6b03a.css"/><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;overflow:hidden}.login-container{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;background:linear-gradient(-45deg,#0a0a0a,#1a1a1a,#121212,#0f0f0f);background-size:400% 400%;animation:gradientShift 15s ease infinite;padding:20px;position:relative;overflow:hidden}@keyframes gradientShift{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}.login-container::before{content:'';position:absolute;width:200%;height:200%;background-image:radial-gradient(circle at 20% 30%,rgba(242,138,48,.05) 0,transparent 50%),radial-gradient(circle at 80% 70%,rgba(255,168,80,.05) 0,transparent 50%),radial-gradient(circle at 50% 50%,rgba(242,138,48,.03) 0,transparent 50%);animation:float 20s ease-in-out infinite}@keyframes float{0%,100%{transform:translate(0,0) rotate(0)}33%{transform:translate(30px,-30px) rotate(120deg)}66%{transform:translate(-20px,20px) rotate(240deg)}}.login-box{background:rgba(26,26,26,.85);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.05);border-radius:24px;padding:48px 40px;width:100%;max-width:420px;box-shadow:0 8px 32px rgba(0,0,0,.5),0 0 0 1px rgba(242,138,48,.1),inset 0 1px 0 rgba(255,255,255,.05);position:relative;z-index:1;animation:slideIn .6s cubic-bezier(.16,1,.3,1)}@keyframes slideIn{0%{opacity:0;transform:translateY(30px) scale(.95)}100%{opacity:1;transform:translateY(0) scale(1)}}.login-header{text-align:center;margin-bottom:36px}.login-logo{width:72px;height:72px;margin:0 auto 20px;display:block;filter:drop-shadow(0 4px 12px rgba(242, 138, 48, .3));animation:pulse 3s ease-in-out infinite}@keyframes pulse{0%,100%{transform:scale(1);filter:drop-shadow(0 4px 12px rgba(242, 138, 48, .3))}50%{transform:scale(1.05);filter:drop-shadow(0 6px 16px rgba(242, 138, 48, .5))}}.login-title{font-size:28px;font-weight:800;margin-bottom:10px;background:linear-gradient(135deg,#f28a30 0,#ffa850 50%,gold 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;letter-spacing:-.5px}.login-subtitle{font-size:14px;color:#999;font-weight:400;letter-spacing:.3px}.login-form{display:flex;flex-direction:column;gap:24px}.form-group{display:flex;flex-direction:column;gap:10px;position:relative}.form-label{font-size:13px;font-weight:600;color:#e0e0e0;letter-spacing:.3px;text-transform:uppercase;font-size:11px;color:#aaa}.form-input{padding:14px 18px;background:rgba(18,18,18,.7);border:1.5px solid rgba(255,255,255,.08);border-radius:12px;font-size:15px;color:#fff;outline:0;transition:all .3s cubic-bezier(.4, 0, .2, 1);font-family:inherit;width:100%}.form-input::-ms-reveal{filter:invert(60%)}.form-input::-webkit-contacts-auto-fill-button,.form-input::-webkit-credentials-auto-fill-button{filter:invert(60%)}.form-input::placeholder{color:#555}.form-input:focus{border-color:rgba(242,138,48,.6);background:rgba(18,18,18,.9);box-shadow:0 0 0 3px rgba(242,138,48,.12),0 4px 12px rgba(0,0,0,.2);transform:translateY(-1px)}.form-input:disabled{background:rgba(10,10,10,.5);cursor:not-allowed;opacity:.5}.login-button{padding:16px 24px;background:linear-gradient(135deg,#f28a30 0,#ffa850 100%);color:#fff;border:none;border-radius:12px;font-size:15px;font-weight:700;cursor:pointer;transition:all .4s cubic-bezier(.4, 0, .2, 1);box-shadow:0 4px 16px rgba(242,138,48,.35),0 0 0 0 rgba(242,138,48,.5);margin-top:12px;letter-spacing:.5px;text-transform:uppercase;font-size:13px;position:relative;overflow:hidden}.login-button::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.login-button:hover:not(:disabled)::before{left:100%}.login-button:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 24px rgba(242,138,48,.45),0 0 0 3px rgba(242,138,48,.2);background:linear-gradient(135deg,#ff9940 0,#ffb860 100%)}.login-button:active:not(:disabled){transform:translateY(0);box-shadow:0 4px 12px rgba(242,138,48,.35),0 0 0 2px rgba(242,138,48,.15)}.login-button:disabled{background:linear-gradient(135deg,#2d2d2d 0,#3a3a3a 100%);cursor:not-allowed;box-shadow:none;opacity:.6}.error-message{background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.3);color:#ff6b6b;padding:14px 18px;border-radius:12px;font-size:13px;text-align:center;margin-top:20px;animation:shake .5s,fadeIn .3s;font-weight:500}@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-10px)}75%{transform:translateX(10px)}}@keyframes fadeIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.success-message{background:rgba(34,197,94,.12);border:1px solid rgba(34,197,94,.35);color:#4ade80;padding:14px 18px;border-radius:12px;font-size:13px;text-align:center;margin-top:20px;animation:fadeIn .3s;font-weight:500}.loading-spinner{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,.25);border-top:2px solid #fff;border-radius:50%;animation:spin .7s linear infinite;margin-right:10px;vertical-align:middle}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.form-input:focus-visible{outline:0}button,input{-webkit-tap-highlight-color:transparent}</style><script defer="defer" src="polyfill.js"></script></head><body><div class="login-container"><div class="login-box"><div class="login-header"><img src="assets/logo-filled.png" alt="InSync Nexus" class="login-logo"/><h1 class="login-title">InSync Nexus</h1><p class="login-subtitle">Sign in to continue</p></div><form class="login-form" id="login-form"><div class="form-group"><label class="form-label" for="username">Username</label> <input id="username" name="username" class="form-input" placeholder="Enter your username" autocomplete="username" required/></div><div class="form-group"><label class="form-label" for="password">Password</label> <input type="password" id="password" name="password" class="form-input" placeholder="Enter your password" autocomplete="current-password" required/></div><button type="submit" class="login-button" id="login-button">Sign In</button></form><div id="message-container"></div></div></div><script>function initializeLoginPage(){const e=document.getElementById("login-form"),t=document.getElementById("username"),n=(document.getElementById("password"),document.getElementById("login-button"),document.getElementById("message-container"),localStorage.getItem("userCredentials"));n?verifyAndRedirect(n):(e.addEventListener("submit",async e=>{e.preventDefault(),await handleLogin()}),t.focus())}async function handleLogin(){const e=document.getElementById("username").value.trim(),t=document.getElementById("password").value,n=document.getElementById("login-button");document.getElementById("message-container");if(e&&t){setFormDisabled(!0),n.innerHTML='<span class="loading-spinner"></span>Signing in...';try{const n=btoa(`${e}:${t}`),o="https://insyncai.duckdns.org",s=await fetch(`${o}/api/login`,{method:"GET",headers:{Authorization:`Basic ${n}`}});if(!s.ok){if(401===s.status)throw new Error("Invalid username or password");throw new Error("Login failed. Please try again.")}const a=await s.json();console.log("Login successful:",a),localStorage.setItem("userCredentials",n),localStorage.setItem("username",a.username),localStorage.setItem("userEmail",a.email),showMessage("Login successful! Redirecting...","success"),setTimeout(()=>{window.location.href="taskpane.html"},1e3)}catch(e){console.error("Login error:",e),showMessage(e.message,"error"),setFormDisabled(!1),n.textContent="Sign In"}}else showMessage("Please enter both username and password","error")}async function verifyAndRedirect(e){try{const t="https://insyncai.duckdns.org";(await fetch(`${t}/api/login`,{method:"GET",headers:{Authorization:`Basic ${e}`}})).ok?window.location.href="taskpane.html":(localStorage.removeItem("userCredentials"),localStorage.removeItem("username"),localStorage.removeItem("userEmail"))}catch(e){console.error("Verification error:",e),localStorage.removeItem("userCredentials")}}function setFormDisabled(e){document.getElementById("username").disabled=e,document.getElementById("password").disabled=e,document.getElementById("login-button").disabled=e}function showMessage(e,t){const n=document.getElementById("message-container"),o="error"===t?"error-message":"success-message";n.innerHTML=`<div class="${o}">${e}</div>`,"error"===t&&setTimeout(()=>{n.innerHTML=""},5e3)}Office.onReady(()=>{console.log("Login page initialized"),initializeLoginPage()})</script></body></html>